# 온디바이스 환경에서 이미지-텍스트 기반 멀티모달 AI 추론을 위한 NPU 하드웨어 가속기 설계
---
## 🦾 Team ModalArc
이화여자대학교 캡스톤디자인과창업프로젝트 연구 팀<br>
하정연, 최윤지, 이지현

본 프로젝트는 **온디바이스 환경에서 멀티모달 AI를 효율적으로 추론하기 위한 NPU 하드웨어 가속기 설계**를 제안합니다. <br> 기존 NPU의 한계인 데이터 이질성, 메모리 병목, 비효율적 스케줄링 등의 문제를 해결하는 것을 목표로 합니다.  <br> ONNXim 시뮬레이터에서 대표적인 이미지 - 텍스트 조합 멀티모달 모델인 CLIP을 실행하고, 제안한 **Modality-Aware Dynamic Scheduler**를 시뮬레이터에 구현하여 성능을 평가합니다.

## 🔑 Research Keywords
`NPU Architecture design` | `On-device AI` | `Multimodal AI` | `Scheduler`

## 💡 Background

**멀티모달 AI의 부상과 온디바이스 컴퓨팅의 중요성**<br>
최근 Google, Tesla와 같은 글로벌 기업들이 자율주행, 로봇, 스마트 디바이스 등 다양한 분야에서 멀티모달 AI를 핵심 기술로 채택하며 그 수요가 급증하고 있습니다. 멀티모달 AI는 이미지, 텍스트, 음성, 액션 등 여러 종류의 데이터를 실시간으로 함께 처리하여 기존 AI 모델보다 훨씬 더 풍부한 정보를 이해하고 복합적인 추론을 수행합니다. <br><br>하지만 복잡한 멀티모달 AI 모델을 클라우드 서버에만 의존해 실행할 경우, 지연 시간 증가, 운영 비용 부담, 네트워크 의존성 등의 문제가 불가피합니다. 이러한 멀티모달 AI 모델을 클라우드 서버에 의존하지 않고, 저전력, 저지연성이 필수적인 온디바이스 환경에서 직접 실행하는 것이 중요한 과제로 떠오르고 있습니다.

**기존 NPU의 한계 및 기술적 도전 과제**<br>
현재 시장에 출시된 대부분의 상용 NPU는 단일 데이터 타입(주로 이미지) 처리에 최적화되어, CNN 연산에 초점을 맞추고 있습니다. 하지만 멀티모달 AI는 이질적인 데이터를 동시에 다루기에 다음과 같은 기술적 문제를 야기합니다.

* Data Heterogeneity로 인한 비효율성: 이미지, 텍스트, 음성, 액션 데이터는 각각 고유한 형태와 연산 패턴을 가지고 있습니다. 기존 NPU는 이러한 이질적인 데이터를 동시에 처리하는 데 적합하지 않아, 자원 활용률 저하와 연산 비효율성이 발생합니다.
* Memory Bottleneck 현상: 멀티모달 모델은 여러 종류의 데이터를 융합하는 과정에서 서로 다른 메모리 영역에 저장된 데이터를 동시에 가져와야 합니다. 이로 인해 한정된 Memory Bandwidth을 두고 여러 연산 유닛이 경쟁하는 Contention이 발생하며, 이는 전체 시스템의 성능을 저하시키는 주요 원인이 됩니다.

이러한 문제들 때문에 기존 NPU에 멀티모달 AI 모델을 그대로 적용하면 성능 저하, 전력 소모 증가 등 여러 비효율이 발생합니다. <br><br>
따라서 온디바이스라는 환경을 고려함과 동시에 멀티모달 AI에 특화된 **새로운 NPU 아키텍처 연구**가 필수적입니다. 

## 🎯 Research Topic and Methodology

### 1. 선행 연구 분석 및 문제 정의
* 우선 멀티 DNN과 관련된 선행 연구 논문들을 심층적으로 분석합니다. 이 과정에서 Heterogeneous Workload Imbalance, Memory Bandwidth Contention, Scheduling, QoS 등 기존 연구가 충분히 고려하지 못한 문제들을 파악합니다.
* GitHub에 오픈 소스로 공개된 POSTECH의 ONNXim NPU 기본 시뮬레이터를 사용하여, 이미지와 텍스트를 조합한 소규모의 대표적인 멀티모달 모델 OPEN AI의 CLIP을 실행합니다. 이때 메모리 접근 패턴, 연산량, 지연 시간 등의 데이터를 프로파일링하여, 성능 병목 현상과 비효율성을 직접 확인하고, 이를 개선하기 위한 설계의 논리적 근거를 마련합니다.

### 2. 아키텍처 제안 및 시뮬레이터 확장
파악한 문제들을 해결하고 멀티모달 AI의 특성과 온디바이스 환경을 고려하여, 다음 핵심 세부 사항들을 포함한 Modality-Aware Dynamic Scheduler를 제안합니다. ONNXim 시뮬레이션 환경을 확장하여 이 스케줄러를 새로운 모듈로 구현하고, 그 성능을 검증하는 것을 목표로 합니다.

* **이질적인 자원 관리**<br>
이미지 처리에는 ViT 기반의 MAC 연산이, 텍스트 처리에는 Transformer 기반의 행렬 곱 연산이 주로 사용되는 등, 멀티모달 모델은 서로 다른 연산 패턴을 포함합니다.
Scheduler는 이러한 모달리티 간 연산 이질성을 사전에 인지하고, 레이어별 연산 특성에 따라 Systolic Array의 논리적 Shape을 동적으로 재구성함으로써 PE 자원의 활용도를 극대화합니다.

* **데이터 흐름 최적화**<br>
멀티모달 AI는 이미지, 텍스트 등 다양한 데이터를 동시에 처리해야 하므로, 데이터 이동 경로와 재사용 방식이 전체 효율에 큰 영향을 미칩니다. 스케줄러는 현재 연산이 이미지인지 텍스트인지 인식하여, Weight-Stationary · Output-Stationary· Input-Stationary와 같은 기존 데이터 흐름 중 가장 효율적인 방식을 동적으로 선택하도록 지시합니다. 이는 데이터 이동 경로를 최적화하여 전력 소모를 줄이는 핵심 기능입니다.

* **데이터 융합 가속**<br>
멀티모달 AI의 핵심은 다양한 모달리티의 데이터를 효과적으로 결합하는 것입니다. Fusion 과정에서 발생하는 연산 병목을 줄이기 위해, 융합 연산을 식별하고 이 특별한 구간에서는 특화된 데이터 흐름을 실행하도록 NPU를 제어합니다. 이는 불필요한 DRAM 접근을 최소화하여 에너지와 지연 시간을 단축시킵니다.

* **온칩 메모리(SRAM) 관리**<br>
온디바이스 기기는 클라우드 서버와 달리 낮은 전력 소모, 제한된 메모리, 짧은 응답 시간이 핵심 요구사항입니다. 멀티모달 모델은 연산량이 많아 NPU의 전력 소모를 크게 증가시키는데, 특히 온칩 SRAM은 전력 소비와 칩 면적에 직결되므로 효율적인 관리가 필요합니다. 스케줄러는 이미지의 규칙적인 접근 패턴과 텍스트의 불규칙한 접근 패턴을 구별합니다. 이에 맞춰 지능형 Prefetching을 지시하는 등 데이터 재사용성을 극대화하는 방향으로 메모리 정책을 동적으로 적용하여, PE가 멈춰서는 대기 시간(Stall)을 최소화합니다.

### 3. 성능 분석 및 평가
* **Workload**: OPEN AI의 CLIP 기반 멀티모달 모델(이미지 인코더 + 텍스트 인코더 + 디코더)을 이용합니다. <br> 
* **평가 지표**: Energy Efficiency, PE Utilization, Latency <br> 
* **목표**: 제안한 아키텍쳐가 기존 NPU 아키텍처 대비 온디바이스 환경에서 성능과 효율을 얼마나 개선하는지 정량적으로 평가합니다. 

## 🙋🏻‍♀️ Project Plan
* 2025년 9월: 선행 연구 분석 및 문제 정의
* 2025년 10월: 프로파일링 실험 통해 설계 주체 구체화
* 2025년 겨울: Modality-Aware Dynamic Scheduler 구현 및 성능 측정 후 아키텍처 최적화
* 2026년 봄: 학회 논문 작성 및 발표
